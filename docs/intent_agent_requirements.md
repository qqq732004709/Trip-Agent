# ğŸ“„ intent\_agent å¼€å‘è¯´æ˜æ–‡æ¡£ï¼ˆç»™ Cursor / åä½œè€…ï¼‰

## ğŸ“Œ ç›®æ ‡

`intent_agent` æ˜¯æ—…è¡ŒåŠ©æ‰‹å¯¹è¯æµç¨‹ä¸­çš„æ ¸å¿ƒ Agentï¼ŒèŒè´£æ˜¯ï¼š

* ğŸ§  åˆ¤æ–­ç”¨æˆ·æ˜¯å¦è¡¨è¾¾äº†æ—…è¡Œæ„å›¾ï¼›
* ğŸ§¾ è‹¥æœ‰æ—…è¡Œæ„å›¾ï¼Œåˆ™æå–ç»“æ„åŒ–æ—…è¡Œéœ€æ±‚ï¼ˆdestination, dates, preferencesï¼‰ï¼›
* â“ è‹¥ä¿¡æ¯ä¸å…¨ï¼Œå¼•å¯¼ç”¨æˆ·è¡¥å……ï¼›
* âœ… è‹¥ä¿¡æ¯å……è¶³ï¼Œæ ‡è®°ä¸º `confirmed = True` å¹¶è¿›å…¥ä¸‹ä¸€é˜¶æ®µï¼›

---

## âœ… è¾“å…¥

```python
state: AgentState = {
  "messages": List[BaseMessage],  # åŒ…å«å®Œæ•´å¯¹è¯å†å²
  "data": Dict,                   # å­˜å‚¨ travel_details
  "metadata": Dict[str, str]      # åŒ…å« model_name / model_provider
}
```

---

## âœ… è¾“å‡º

* ä¿®æ”¹ï¼š

  ```python
  state["data"]["travel_details"] = ItineraryRequest.dict()
  ```
* è¿”å›ä¸€æ¡ AIMessage å†…å®¹ï¼š

  * ä¿¡æ¯è¶³å¤Ÿ â†’ å›å¤â€œå·²è·å–å…¨éƒ¨éœ€æ±‚â€¦â€
  * ä¿¡æ¯ä¸å…¨ â†’ å›å¤è¡¥å……é—®é¢˜åˆ—è¡¨
  * æ— æ„å›¾ â†’ å›å¤é»˜è®¤è¯´æ˜å¹¶ç»ˆæ­¢

---

## ğŸ§  é€»è¾‘æµç¨‹

1. æ±‡æ€»å¯¹è¯å†å²ä¸º `conversation` æ–‡æœ¬ï¼›
2. è°ƒç”¨ `parse_user_input(conversation)`ï¼ŒLLM ä¸€æ¬¡æ€§å®Œæˆï¼š

   * æ„å›¾åˆ¤æ–­
   * ä¿¡æ¯æå–
3. å¦‚æœç»“æœå­—æ®µéƒ½ä¸ºç©º â†’ æ— æ—…è¡Œæ„å›¾ï¼›
4. å¦‚æœå­—æ®µä¸å®Œæ•´ â†’ å‘å‡ºè¡¥å……é—®é¢˜ï¼›
5. å­—æ®µé½å…¨ â†’ `confirmed = True`ï¼Œè¿›å…¥ä¸‹ä¸€é˜¶æ®µ

---

## ğŸ“¦ æ•°æ®ç»“æ„

```python
class ItineraryRequest(BaseModel):
    destination: str
    start_date: str
    end_date: str
    preferences: Dict[str, List[str] | str]
    confirmed: bool
```

å­—æ®µè¯´æ˜ï¼š

* `confirmed` ç”±ç³»ç»Ÿåˆ¤æ–­è®¾ç½®ï¼Œä¸ç”± LLM ç”Ÿæˆ
* æ»¡è¶³ destination + preferences å³å¯è§†ä¸ºå¯ç¡®è®¤

---

## ğŸ” ä¸¥æ ¼çº¦æŸï¼ˆCursor ä¸¥æ ¼éµå®ˆï¼‰

* âŒ ä¸è¦è°ƒç”¨å¤šä¸ª LLMï¼ˆæ‰€æœ‰æ„å›¾åˆ¤æ–­ + ä¿¡æ¯æå–ç”±ä¸€ä¸ª prompt å®Œæˆï¼‰
* âŒ ä¸è¦è®© LLM è¿”å› confirmed å­—æ®µï¼Œå¿…é¡»ç”±ä»£ç é€»è¾‘åˆ¤æ–­
* âœ… å¦‚æœæå–å¤±è´¥ï¼Œä½¿ç”¨é»˜è®¤ç©ºç»“æ„ fallback
* âœ… å¦‚æœå†…å®¹æ¨¡ç³Šä½†å¯èƒ½å­˜åœ¨æ—…è¡Œæ„å›¾ï¼Œå…è®¸å¼•å¯¼ç»§ç»­æé—®

---

## ğŸ›  è°ƒè¯•å»ºè®®

```python
print("ğŸ§  LLM extract:", extracted.dict())
print("ğŸ§­ confirmed:", extracted.confirmed)
```

---

## ğŸ“åç»­æ‰©å±•å»ºè®®

* æ”¯æŒè¯†åˆ«â€œæ”¾å¼ƒæ—…è¡Œâ€ç±»æ„å›¾ï¼ˆå¦‚â€œæˆ‘ä¸å»äº†â€ï¼‰
* æ”¯æŒåˆå¹¶è¡¥å……è¾“å…¥ï¼ˆå¤šè½®å¡«ç©ºï¼‰
* æ”¯æŒé€‰æ‹©æ¨èæ–¹æ¡ˆ vs è‡ªå®šä¹‰
